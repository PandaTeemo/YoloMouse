<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="YoloMouse" Language="1033" Version="0.6.0.0" Manufacturer="HaPpY" UpgradeCode="69ce184e-a676-4169-a124-e1ee073bd0e6">

    <Package Id="*" InstallerVersion="200" Compressed="yes" InstallPrivileges="elevated" InstallScope="perMachine" />
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="YoloMouse" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentGroupRef Id="CursorDefaultComponents" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="APPLICATIONROOTDIRECTORY" Name="YoloMouse">
          <Directory Id="CURSOR_DIR" Name="Cursors">
            <Directory Id="CURSOR_DEFAULT_DIR" Name="Default" />
          </Directory>
        </Directory>
        <Directory Id="ProgramMenuFolder">
          <Directory Id="ApplicationProgramsFolder" Name="YoloMouse"/>
        </Directory>
      </Directory>
    </Directory>

    <ComponentGroup Id="ProductComponents" Directory="APPLICATIONROOTDIRECTORY">
      <Component Guid="{B77158E0-4FC0-4323-975B-D3C3766D081E}">
        <File Id="YoloMouseExe" Source="$(var.YoloMouse.Loader.TargetPath)" KeyPath="yes" Checksum="yes"/>
      </Component>
      <Component Guid="{196DF733-044D-43D2-A79C-E230B10633F1}">
        <File Source="$(var.YoloMouse.Dll.TargetPath)" KeyPath="yes" Checksum="yes" />
      </Component>
      <Component Id="SettingsIni" Guid="{445DA01E-1460-4A6D-A9D1-E2B07F503AD3}">
        <RemoveFile Id="SettingsIni" On="uninstall" Name="Settings.ini" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="CursorDefaultComponents" Directory="CURSOR_DEFAULT_DIR">
      <Component Id="DefaultCursor0" Guid="{5E10BC33-97A3-4E32-B001-9127DE1FCDF0}">
        <File Id="DefaultCursor0" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\0.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor1" Guid="{99AD6A0F-4C1A-4301-96A5-251338593893}">
        <File Id="DefaultCursor1" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\1.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor2" Guid="{53578FF5-8705-4F3E-AB04-43E3CF66990F}">
        <File Id="DefaultCursor2" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\2.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor3" Guid="{E78E5371-AFC6-4AED-81EE-42C3F53BC213}">
        <File Id="DefaultCursor3" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\3.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor4" Guid="{15674144-1408-4D2A-8305-819535CD265E}">
        <File Id="DefaultCursor4" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\4.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor5" Guid="{1B967E98-5606-4C56-95E9-16A3AFCD66F2}">
        <File Id="DefaultCursor5" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\5.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor6" Guid="{3B350B53-4BAE-4059-BEF0-5BDAFD92695A}">
        <File Id="DefaultCursor6" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\6.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor7" Guid="{DF8982F7-BFD5-4070-A7DC-4F1CEEEDE714}">
        <File Id="DefaultCursor7" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\7.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor8" Guid="{ADD51E21-2CE7-4166-B090-8EA58980CB66}">
        <File Id="DefaultCursor8" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\8.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor9" Guid="{E2A26591-DCF4-4C56-AE74-D6E69A56CA57}">
        <File Id="DefaultCursor9" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\9.cur" KeyPath="yes" />
      </Component>

      <Component Id="DefaultCursor10" Guid="{CE3C4759-1D1D-4BF8-8611-B117DEE0D2D8}">
        <File Id="DefaultCursor10" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\10.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor11" Guid="{2C5B7F69-45CF-49C7-AC51-DE472ACC82E3}">
        <File Id="DefaultCursor11" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\11.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor12" Guid="{B03237A5-0671-461A-AB1B-4B256479045D}">
        <File Id="DefaultCursor12" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\12.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor13" Guid="{E54614DC-01F9-4014-A6E6-4E4859F4DD28}">
        <File Id="DefaultCursor13" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\13.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor14" Guid="{EEFFBD33-971D-454E-BAEF-2DD8194511E0}">
        <File Id="DefaultCursor14" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\14.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor15" Guid="{AA791525-4A02-4521-990C-E7B78FCA492F}">
        <File Id="DefaultCursor15" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\15.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor16" Guid="{E49D0FA2-347A-46A9-9123-642D7E9B7452}">
        <File Id="DefaultCursor16" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\16.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor17" Guid="{7A7817EF-DFCD-49CF-A8FA-AC259A212A73}">
        <File Id="DefaultCursor17" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\17.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor18" Guid="{2FCCAE10-533D-40D3-907C-E0F70544D0FF}">
        <File Id="DefaultCursor18" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\18.cur" KeyPath="yes" />
      </Component>
      <Component Id="DefaultCursor19" Guid="{AF960D90-CB15-4838-BD60-5C66A4F866FC}">
        <File Id="DefaultCursor19" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\19.cur" KeyPath="yes" />
      </Component>

      <Component Id="DefaultCursor80" Guid="{B6693082-6BFF-48B9-8E30-D9864E09E70B}">
        <File Id="DefaultCursor80" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Default\80.ani" KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="{00797B6E-D869-4803-99DE-A050B383653E}">
        <Shortcut Id="ApplicationStartMenuShortcut"
          Name="YoloMouse"
          Description="Game Cursor Changer"
          Target="[#YoloMouseExe]"
          WorkingDirectory="APPLICATIONROOTDIRECTORY"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\Microsoft\YoloMouse" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <Icon Id="APP_ICON" SourceFile="..\..\source\YoloMouse\Loader\Resource\AppIcon.ico"/>
    <Property Id="ARPPRODUCTICON" Value="APP_ICON" />

    <Property Id="WIXUI_INSTALLDIR" Value="APPLICATIONROOTDIRECTORY" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch YoloMouse" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX" Value="1" />
    <Property Id="WixShellExecTarget" Value="[#YoloMouseExe]" />
    <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />

    <UI>
      <UIRef Id="WixUI_InstallDir"/>
      <DialogRef Id="FilesInUse" />
      <DialogRef Id="MsiRMFilesInUse" />
      <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
    </UI>

  </Product>
</Wix>